{"ast":null,"code":"import _classCallCheck from \"/Volumes/Angela He/treehacks/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Volumes/Angela He/treehacks/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Volumes/Angela He/treehacks/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Volumes/Angela He/treehacks/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Volumes/Angela He/treehacks/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Volumes/Angela He/treehacks/src/components/Feed/Post.js\";\nimport React from 'react';\nimport Avatar from '../Misc/Avatar';\nimport CommentBox from './CommentBox';\nimport CommentBut from './CommentBut';\nimport Comments from './Comments';\nimport MoreButton from './MoreButton';\nimport StaticUtil from '../../data/StaticUtil';\nimport StaticDataModel from '../../data/StaticDataModel';\n/*\n  props:\n-PpfURL\n-yourPpfURL\n-firebase\n-postid\n-uid\n-postClass\n-actionStr\n-name\n-timestamp\n-content\n-setEdit\n*/\n\nvar Post =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Post, _React$Component);\n\n  function Post(props) {\n    var _this;\n\n    _classCallCheck(this, Post);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Post).call(this, props));\n\n    _this.loadedComments = function () {\n      return _this.state.conversation.length !== 0;\n    };\n\n    _this.loadComments = function () {\n      if (!_this.loadedComments()) {\n        //load comments\n        var tempConvo = []; //get once snapshot\n\n        _this.props.firebase.postConversation(_this.props.postid).get().then(function (querySnapshot) {\n          querySnapshot.forEach(function (doc) {\n            tempConvo.push(StaticDataModel.getConvoObject(doc.id, doc.data(), _this.props.uid));\n          }); //at end, set state of conversation and showconversation\n\n          tempConvo.sort(StaticUtil.compareTimestamps);\n\n          _this.setState(StaticDataModel.getPostObject(tempConvo, tempConvo.length, !_this.state.showComments));\n        });\n      } else {\n        _this.setState({\n          showComments: !_this.state.showComments\n        });\n      }\n    };\n\n    _this.editPost = function () {\n      _this.props.setEdit();\n    };\n\n    _this.deletePost = function () {\n      //delete post thread in posts\n      _this.props.firebase.post(_this.props.postid).delete().then(function () {}).catch(function (error) {}); //go to everyone in props.yourNetwork and delete the post\n\n\n      var network = _this.props.yourNetwork;\n\n      for (var i = 0; i < network.length; i++) {\n        _this.props.firebase.feed(network[i]).doc(_this.props.postid).delete();\n      }\n    };\n\n    _this.getEditOptions = function () {\n      //is own post\n      if (_this.props.posterUid == _this.props.uid) {\n        var options = [{\n          text: 'Delete',\n          onClick: _this.deletePost,\n          class: 'red'\n        }];\n\n        if (_this.props.setEdit != null) {\n          options.push({\n            text: 'Edit',\n            onClick: _this.editPost,\n            class: 'green'\n          });\n        }\n\n        return options;\n      } else {\n        return [{\n          text: 'Mute',\n          onClick: function onClick() {\n            return _this.props.firebase.mutePoster(_this.props.uid, _this.props.posterUid);\n          },\n          class: 'grey'\n        }, {\n          text: 'Report',\n          onClick: function onClick() {\n            return _this.props.firebase.reportPost(_this.props.uid, _this.props.postid);\n          },\n          class: 'grey'\n        }];\n      }\n    };\n\n    _this.editComment = function (convoid, newMessage) {\n      _this.props.firebase.postConversation(_this.props.postid).doc(convoid).update({\n        message: newMessage\n      });\n    };\n\n    _this.deleteComment = function (convoid) {\n      _this.props.firebase.postConversation(_this.props.postid).doc(convoid).delete().then(function () {}).catch(function (error) {});\n    };\n\n    _this.state = StaticDataModel.getPostObject([], 0, false);\n    return _this;\n  }\n\n  _createClass(Post, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.props.firebase.postConversation(this.props.postid).onSnapshot(function (snapshot) {\n        var tempConvo = _this2.state.conversation;\n\n        if (_this2.loadedComments()) {\n          snapshot.docChanges().forEach(function (change) {\n            var doc = change.doc;\n\n            if (change.type === \"added\") {\n              tempConvo.push(StaticDataModel.getConvoObject(doc.id, doc.data(), _this2.props.uid));\n            }\n\n            if (change.type === \"modified\") {\n              var index = tempConvo.map(function (e) {\n                return e.convoid;\n              }).indexOf(doc.id);\n              tempConvo[index] = StaticDataModel.getConvoObject(doc.id, doc.data(), _this2.props.uid);\n            }\n\n            if (change.type === \"removed\") {\n              var _index = tempConvo.map(function (e) {\n                return e.convoid;\n              }).indexOf(doc.id);\n\n              tempConvo.splice(_index, 1);\n            }\n          });\n        }\n\n        _this2.setState({\n          conversation: tempConvo,\n          conversationLength: snapshot.size\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: this.props.postClass + \" activity\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"header\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }, React.createElement(Avatar, {\n        PpfURL: this.props.PpfURL,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"name-date\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"name\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }, this.props.name), React.createElement(\"span\", {\n        className: \"sub\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }, ' ' + this.props.actionStr)), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"date\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, this.props.timestamp))), React.createElement(MoreButton, {\n        modalOptions: this.getEditOptions(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167\n        },\n        __self: this\n      })), this.props.content, React.createElement(CommentBut, {\n        loadComments: this.loadComments,\n        commentLength: this.state.conversationLength,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }), React.createElement(Comments, {\n        showComments: this.state.showComments,\n        conversation: this.state.conversation,\n        deleteComment: this.deleteComment,\n        editComment: this.editComment,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }), React.createElement(CommentBox, {\n        showComments: this.state.showComments,\n        uid: this.props.uid,\n        PpfURL: this.props.yourPpfURL,\n        poster: this.props.name,\n        firebase: this.props.firebase,\n        postid: this.props.postid,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Post;\n}(React.Component);\n\n;\nexport default Post;","map":{"version":3,"sources":["/Volumes/Angela He/treehacks/src/components/Feed/Post.js"],"names":["React","Avatar","CommentBox","CommentBut","Comments","MoreButton","StaticUtil","StaticDataModel","Post","props","loadedComments","state","conversation","length","loadComments","tempConvo","firebase","postConversation","postid","get","then","querySnapshot","forEach","doc","push","getConvoObject","id","data","uid","sort","compareTimestamps","setState","getPostObject","showComments","editPost","setEdit","deletePost","post","delete","catch","error","network","yourNetwork","i","feed","getEditOptions","posterUid","options","text","onClick","class","mutePoster","reportPost","editComment","convoid","newMessage","update","message","deleteComment","onSnapshot","snapshot","docChanges","change","type","index","map","e","indexOf","splice","conversationLength","size","postClass","PpfURL","name","actionStr","timestamp","content","yourPpfURL","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Avatar from '../Misc/Avatar';\nimport CommentBox from './CommentBox';\nimport CommentBut from './CommentBut';\nimport Comments from './Comments';\nimport MoreButton from './MoreButton';\nimport StaticUtil from '../../data/StaticUtil';\nimport StaticDataModel from '../../data/StaticDataModel';\n\n/*\n  props:\n-PpfURL\n-yourPpfURL\n-firebase\n-postid\n-uid\n-postClass\n-actionStr\n-name\n-timestamp\n-content\n-setEdit\n*/\n\nclass Post extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = StaticDataModel.getPostObject([], 0, false);\n  }\n\n  componentDidMount() {\n    this.props.firebase.postConversation(this.props.postid).onSnapshot((snapshot) => {\n\n      let tempConvo = this.state.conversation;\n\n      if (this.loadedComments()) {\n        snapshot.docChanges().forEach((change) => {\n          let doc = change.doc;\n          if (change.type === \"added\") {\n            tempConvo.push(StaticDataModel.getConvoObject(doc.id, doc.data(), this.props.uid))\n          }\n          if (change.type === \"modified\") {\n            let index = tempConvo.map(function (e) { return e.convoid; }).indexOf(doc.id);\n            tempConvo[index] = StaticDataModel.getConvoObject(doc.id, doc.data(), this.props.uid)\n          }\n          if (change.type === \"removed\") {\n            let index = tempConvo.map(function (e) { return e.convoid; }).indexOf(doc.id);\n            tempConvo.splice(index, 1);\n          }\n        });\n      }\n      this.setState({\n        conversation: tempConvo,\n        conversationLength: snapshot.size\n      });\n    });\n  }\n\n  loadedComments = () => {\n    return this.state.conversation.length !== 0;\n  }\n\n  loadComments = () => {\n    if (!this.loadedComments()) {\n      //load comments\n      let tempConvo = [];\n      //get once snapshot\n      this.props.firebase.postConversation(this.props.postid).get().then((querySnapshot) => {\n        querySnapshot.forEach((doc) => {\n          tempConvo.push(StaticDataModel.getConvoObject(doc.id, doc.data(), this.props.uid))\n        });\n\n        //at end, set state of conversation and showconversation\n        tempConvo.sort(StaticUtil.compareTimestamps);\n\n        this.setState(StaticDataModel.getPostObject(\n          tempConvo,\n          tempConvo.length,\n          !this.state.showComments));\n      });\n\n    } else {\n      this.setState({ showComments: !this.state.showComments })\n    }\n  }\n\n  editPost = () => {\n    this.props.setEdit();\n  }\n\n  deletePost = () => {\n\n    //delete post thread in posts\n    this.props.firebase.post(this.props.postid).delete()\n      .then(() => { })\n      .catch((error) => { });\n\n    //go to everyone in props.yourNetwork and delete the post\n    const network = this.props.yourNetwork;\n    for (let i = 0; i < network.length; i++) {\n      this.props.firebase.feed(network[i]).doc(this.props.postid).delete();\n    }\n  }\n\n  getEditOptions = () => {\n    //is own post\n    if (this.props.posterUid == this.props.uid) {\n      let options = [\n        {\n          text: 'Delete',\n          onClick: this.deletePost,\n          class: 'red'\n        }\n      ];\n      if (this.props.setEdit != null) {\n        options.push({\n          text: 'Edit',\n          onClick: this.editPost,\n          class: 'green'\n        });\n      }\n      return options;\n    }\n    else {\n      return [\n        {\n          text: 'Mute',\n          onClick: () => this.props.firebase.mutePoster(this.props.uid,\n            this.props.posterUid),\n          class: 'grey'\n        },\n        {\n          text: 'Report',\n          onClick: () => this.props.firebase.reportPost(this.props.uid,\n            this.props.postid),\n          class: 'grey'\n        }\n      ];\n    }\n  }\n\n  editComment = (convoid, newMessage) => {\n    this.props.firebase.postConversation(this.props.postid)\n      .doc(convoid)\n      .update({\n        message: newMessage\n      });\n  }\n\n  deleteComment = (convoid) => {\n    this.props.firebase.postConversation(this.props.postid).doc(convoid).delete()\n      .then(() => { })\n      .catch((error) => { });\n  }\n\n  render() {\n    return (\n      <div className={this.props.postClass + \" activity\"}>\n\n        <div className=\"header\">\n          <Avatar PpfURL={this.props.PpfURL} />\n          <div className=\"name-date\">\n            <div><span className=\"name\">{this.props.name}</span>\n              <span className=\"sub\">{' ' + this.props.actionStr}</span></div>\n            <div><span className=\"date\">{this.props.timestamp}</span></div>\n          </div>\n          <MoreButton\n            modalOptions={this.getEditOptions()}\n          />\n        </div>\n\n        {this.props.content}\n\n        <CommentBut\n          loadComments={this.loadComments}\n          commentLength={this.state.conversationLength}\n        />\n        <Comments\n          showComments={this.state.showComments}\n          conversation={this.state.conversation}\n          deleteComment={this.deleteComment}\n          editComment={this.editComment}\n        />\n        <CommentBox\n          showComments={this.state.showComments}\n          uid={this.props.uid}\n          PpfURL={this.props.yourPpfURL}\n          poster={this.props.name}\n          firebase={this.props.firebase}\n          postid={this.props.postid}\n        />\n      </div>\n    );\n  }\n};\n\nexport default Post;\n"]},"metadata":{},"sourceType":"module"}