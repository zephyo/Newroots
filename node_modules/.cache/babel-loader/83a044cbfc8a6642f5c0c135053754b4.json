{"ast":null,"code":"import _classCallCheck from \"/Volumes/Angela He/treehacks/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Volumes/Angela He/treehacks/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Volumes/Angela He/treehacks/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Volumes/Angela He/treehacks/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Volumes/Angela He/treehacks/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Volumes/Angela He/treehacks/src/components/User/Settings/DeleteAccount.js\";\nimport React from 'react';\nimport Loading from '../../Misc/Loading';\nimport SimpleModal from '../../Misc/SimpleModal';\n/*\nfirebase\nthis uid\nremoveUser\n*/\n\nvar deleteStates = {\n  NONE: {},\n  POPUP: {\n    title: 'Are you sure?',\n    p: 'If you delete your account, all your user data will be permanently deleted.'\n  },\n  REAUTH: {\n    title: 'Re-enter your password.',\n    p: 'We need to verify you\\'re the owner of this account.' //input password\n\n  },\n  DELETING: {//loading icon\n  },\n  DELETED: {\n    title: 'Your account is deleted.',\n    p: 'Have a great rest of your day.' //ok\n\n  },\n  FAILED: {\n    title: 'Your account could not be deleted.',\n    p: 'Check your connection and try again.'\n  }\n};\n\nvar DeleteAccount =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(DeleteAccount, _React$Component);\n\n  function DeleteAccount(props) {\n    var _this;\n\n    _classCallCheck(this, DeleteAccount);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(DeleteAccount).call(this, props));\n\n    _this.setDeleteState = function (dState) {\n      _this.setState({\n        deleteState: dState\n      });\n    };\n\n    _this.setPassword = function (e) {\n      _this.setState({\n        password: e.target.value\n      });\n    };\n\n    _this.verifyAndDelete = function () {\n      _this.setDeleteState(deleteStates.DELETING);\n\n      _this.props.firebase.reAuth(_this.state.password, function (user) {\n        /*\n          if couldn't delete user, show failed. \n          if deleted user but couldn't delete data, show success.\n          if deleted everything, show success.\n        */\n        //delete user\n        user.delete().then(function () {\n          //delete user data\n          _this.props.firebase.user(_this.props.uid).delete().then(function () {\n            _this.finishAndSignOut();\n          }).catch(function (error) {\n            _this.finishAndSignOut();\n          });\n        }).catch(function (error) {\n          _this.setDeleteState(deleteStates.FAILED);\n        });\n      }, function (error) {\n        _this.setDeleteState(deleteStates.FAILED);\n      });\n    };\n\n    _this.finishAndSignOut = function () {\n      _this.setDeleteState(deleteStates.DELETED);\n    };\n\n    _this.state = {\n      deleteState: deleteStates.NONE,\n      password: ''\n    };\n    return _this;\n  }\n\n  _createClass(DeleteAccount, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var dButton = React.createElement(\"button\", {\n        className: \"delete-but long\",\n        onClick: function onClick() {\n          return _this2.setDeleteState(deleteStates.POPUP);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }, \"Delete account\");\n      var footer = null;\n\n      switch (this.state.deleteState) {\n        case deleteStates.NONE:\n          return React.createElement(\"div\", {\n            className: \"delete-container\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 96\n            },\n            __self: this\n          }, dButton);\n\n        case deleteStates.POPUP:\n          footer = React.createElement(\"footer\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 101\n            },\n            __self: this\n          }, React.createElement(\"button\", {\n            onClick: function onClick() {\n              return _this2.setDeleteState(deleteStates.REAUTH);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 102\n            },\n            __self: this\n          }, \"Yes\"), React.createElement(\"button\", {\n            onClick: function onClick() {\n              return _this2.setDeleteState(deleteStates.NONE);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 103\n            },\n            __self: this\n          }, \"No\"));\n          return;\n\n        case deleteStates.REAUTH:\n          footer = React.createElement(\"footer\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 108\n            },\n            __self: this\n          }, React.createElement(\"input\", {\n            type: \"password\",\n            placeholder: \"Password\",\n            onChange: this.setPassword,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 109\n            },\n            __self: this\n          }), React.createElement(\"button\", {\n            onClick: this.verifyAndDelete,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 110\n            },\n            __self: this\n          }, \"Delete\"));\n          return;\n\n        case deleteStates.DELETING:\n          footer = React.createElement(Loading, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 115\n            },\n            __self: this\n          });\n          return;\n\n        case deleteStates.DELETED:\n          footer = React.createElement(\"footer\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 120\n            },\n            __self: this\n          }, React.createElement(\"button\", {\n            onClick: this.props.removeUser,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 121\n            },\n            __self: this\n          }, \"Ok\"));\n          return;\n\n        case deleteStates.FAILED:\n          footer = React.createElement(\"footer\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 127\n            },\n            __self: this\n          }, React.createElement(\"button\", {\n            onClick: function onClick() {\n              return _this2.setDeleteState(deleteStates.NONE);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 128\n            },\n            __self: this\n          }, \"Ok\"));\n          return;\n      }\n\n      return React.createElement(\"div\", {\n        className: \"delete-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }, dButton, React.createElement(SimpleModal, {\n        title: this.state.deleteState.title,\n        p: this.state.deleteState.p,\n        footer: footer,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return DeleteAccount;\n}(React.Component);\n\nexport default DeleteAccount;","map":{"version":3,"sources":["/Volumes/Angela He/treehacks/src/components/User/Settings/DeleteAccount.js"],"names":["React","Loading","SimpleModal","deleteStates","NONE","POPUP","title","p","REAUTH","DELETING","DELETED","FAILED","DeleteAccount","props","setDeleteState","dState","setState","deleteState","setPassword","e","password","target","value","verifyAndDelete","firebase","reAuth","state","user","delete","then","uid","finishAndSignOut","catch","error","dButton","footer","removeUser","Component"],"mappings":"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","sourcesContent":["\nimport React from 'react';\nimport Loading from '../../Misc/Loading'\nimport SimpleModal from '../../Misc/SimpleModal';\n/*\nfirebase\nthis uid\nremoveUser\n*/\nconst deleteStates = {\n  NONE: {},\n  POPUP: {\n    title: 'Are you sure?',\n    p: 'If you delete your account, all your user data will be permanently deleted.'\n  },\n  REAUTH: {\n    title: 'Re-enter your password.',\n    p: 'We need to verify you\\'re the owner of this account.'\n    //input password\n  },\n  DELETING: {\n    //loading icon\n  },\n  DELETED: {\n    title: 'Your account is deleted.',\n    p: 'Have a great rest of your day.'\n    //ok\n  },\n  FAILED: {\n    title: 'Your account could not be deleted.',\n    p: 'Check your connection and try again.'\n  }\n};\n\n\nclass DeleteAccount extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      deleteState: deleteStates.NONE,\n      password: ''\n    };\n  }\n\n  setDeleteState = (dState) => {\n    this.setState({ deleteState: dState })\n  }\n\n  setPassword = (e) => {\n    this.setState({ password: e.target.value })\n  }\n\n  verifyAndDelete = () => {\n    this.setDeleteState(deleteStates.DELETING)\n\n    this.props.firebase.reAuth(this.state.password, (user) => {\n\n      /*\n        if couldn't delete user, show failed. \n        if deleted user but couldn't delete data, show success.\n        if deleted everything, show success.\n      */\n      //delete user\n      user.delete().then(() => {\n\n        //delete user data\n        this.props.firebase.user(this.props.uid).delete().then(() => {\n          this.finishAndSignOut();\n        }).catch((error) => {\n          this.finishAndSignOut();\n        });\n\n      }).catch((error) => {\n        this.setDeleteState(deleteStates.FAILED)\n      });\n\n    },\n      (error) => {\n        this.setDeleteState(deleteStates.FAILED)\n      });\n  }\n\n  finishAndSignOut = () => {\n    this.setDeleteState(deleteStates.DELETED)\n  }\n\n  render() {\n    let dButton = (\n      <button className=\"delete-but long\"\n        onClick={() => this.setDeleteState(deleteStates.POPUP)}>Delete account</button>\n    );\n    let footer = null;\n\n    switch (this.state.deleteState) {\n      case deleteStates.NONE:\n        return <div className=\"delete-container\">\n          {dButton}\n        </div>;\n      case deleteStates.POPUP:\n        footer =\n          <footer>\n            <button onClick={() => this.setDeleteState(deleteStates.REAUTH)}>Yes</button>\n            <button onClick={() => this.setDeleteState(deleteStates.NONE)}>No</button>\n          </footer>;\n        return;\n      case deleteStates.REAUTH:\n        footer =\n          <footer>\n            <input type=\"password\" placeholder=\"Password\" onChange={this.setPassword} />\n            <button onClick={this.verifyAndDelete}>Delete</button>\n          </footer>\n        return;\n      case deleteStates.DELETING:\n        footer =\n          <Loading />\n          ;\n        return;\n      case deleteStates.DELETED:\n        footer =\n          <footer>\n            <button onClick={this.props.removeUser}>Ok</button>\n          </footer>\n          ;\n        return;\n      case deleteStates.FAILED:\n        footer =\n          <footer>\n            <button onClick={() => this.setDeleteState(deleteStates.NONE)}>Ok</button>\n          </footer>\n          ;\n        return;\n    }\n    return <div className=\"delete-container\">\n      {dButton}\n      <SimpleModal\n        title={this.state.deleteState.title}\n        p={this.state.deleteState.p}\n        footer={footer}\n      />\n    </div>;\n  }\n}\n\n\nexport default DeleteAccount;"]},"metadata":{},"sourceType":"module"}