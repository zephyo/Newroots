{"ast":null,"code":"import _classCallCheck from \"/Volumes/Angela He/treehacks/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Volumes/Angela He/treehacks/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Volumes/Angela He/treehacks/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Volumes/Angela He/treehacks/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Volumes/Angela He/treehacks/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Volumes/Angela He/treehacks/src/components/Network/AddFriend.js\";\nimport React from 'react';\nimport plant from '../../graphics/icon.png';\nimport $ from 'jquery';\nimport Avatar from '../Misc/Avatar';\nimport UserRow from './UserRow';\nimport ListOfUsers from './ListOfUsers';\nimport StaticUtil from '../../data/StaticUtil';\n\nvar AddFriend =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(AddFriend, _React$Component);\n\n  function AddFriend(props) {\n    var _this;\n\n    _classCallCheck(this, AddFriend);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AddFriend).call(this, props));\n\n    _this.setFindFriend = function (mssg) {\n      return _this.setState({\n        addedFriend: mssg\n      });\n    };\n\n    _this.setInvitedFriend = function (mssg) {\n      return _this.setState({\n        invitedFriend: mssg\n      });\n    };\n\n    _this.inviteFriend = function () {\n      return _this.setInvitedFriend('invited!');\n    };\n\n    _this.genList = function (ref, search_val) {\n      var tempSug = [];\n      ref.get().then(function (querySnapshot) {\n        querySnapshot.forEach(function (doc) {\n          tempSug.push({\n            uid: doc.id,\n            name: doc.data().name,\n            url: doc.data().PpfURL\n          });\n        });\n\n        _this.setState({\n          suggestions: tempSug\n        });\n      }).catch(function (err) {\n        _this.setFindFriend(\"couldn't find \" + search_val);\n      });\n    };\n\n    _this.sendRequest = function (uid) {\n      _this.props.firebase.requests(uid).doc(_this.props.uid).set({\n        exists: true\n      }).then(function () {\n        _this.setFindFriend('sent request!');\n      });\n    };\n\n    _this.findFriend = function () {\n      var ref = \"\";\n      var search_val = $('#add-friend-email').val();\n\n      if (StaticUtil.isValidEmail(search_val)) {\n        ref = _this.props.firebase.users().where(\"email\", \"==\", search_val);\n      } else {\n        search_val = search_val.toLowerCase();\n        ref = _this.props.firebase.users().where(\"easy_name\", \"==\", search_val);\n      }\n\n      _this.genList(ref, search_val);\n    };\n\n    _this.acceptRequest = function (uid) {\n      //remove uid from your request\n      _this.removeRequest(uid);\n\n      _this.props.firebase.addToNetwork(_this.props.uid, uid);\n\n      _this.props.firebase.addToFeed(_this.props.uid, uid);\n    };\n\n    _this.removeRequest = function (uid) {\n      _this.props.firebase.requests(_this.props.uid).doc(uid).delete();\n    };\n\n    _this.renderUser = function (user, key) {\n      return React.createElement(\"div\", {\n        className: \"preview\",\n        key: key,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93\n        },\n        __self: this\n      }, React.createElement(Avatar, {\n        PpfURL: user.PpfURL,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94\n        },\n        __self: this\n      }), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95\n        },\n        __self: this\n      }, user.name), React.createElement(\"div\", {\n        className: \"yesno\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"yes\",\n        onClick: function onClick() {\n          return _this.acceptRequest(user.uid);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"jam jam-check\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98\n        },\n        __self: this\n      })), React.createElement(\"button\", {\n        className: \"no\",\n        onClick: function onClick() {\n          return _this.removeRequest(user.uid);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"jam jam-close\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101\n        },\n        __self: this\n      }, \" \"))));\n    };\n\n    _this.state = {\n      requests: _this.props.requests,\n      network: _this.props.network,\n      addedFriend: '',\n      invitedFriend: '',\n      suggestions: []\n    };\n    return _this;\n  }\n\n  _createClass(AddFriend, [{\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      if (nextProps.requests !== this.state.requests) {\n        this.setState({\n          requests: nextProps.requests\n        });\n      }\n\n      if (nextProps.network !== this.state.network) {\n        this.setState({\n          network: nextProps.network\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var length = this.state.suggestions.length;\n      var suggestions = this.state.suggestions.map(function (sug, index) {\n        return React.createElement(UserRow, {\n          onProfileClick: function onProfileClick() {\n            return _this2.props.setUserPage(sug);\n          },\n          PpfURL: sug.url,\n          name: sug.name,\n          rightElement: React.createElement(\"button\", {\n            onClick: function onClick() {\n              return _this2.sendRequest(sug.uid);\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 115\n            },\n            __self: this\n          }, React.createElement(\"span\", {\n            className: \"jam jam-user-plus\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 116\n            },\n            __self: this\n          })),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 110\n          },\n          __self: this\n        });\n      });\n      return React.createElement(\"div\", {\n        className: \"modal network\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"close\",\n        onClick: function onClick() {\n          return _this2.props.setAddFriend(false);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"jam jam-close\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      })), React.createElement(\"img\", {\n        className: \"plant\",\n        src: plant,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }), React.createElement(ListOfUsers, {\n        containerClass: \"scrolling-row\",\n        firebase: this.props.firebase,\n        uid: this.props.uid,\n        listName: \"requests\",\n        renderFunc: this.renderUser,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"add-friend\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }, \"Find friends\"), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, \" \", this.state.addedFriend, \" \"), React.createElement(\"div\", {\n        className: \"network-input\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        id: \"add-friend-email\",\n        type: \"email\",\n        placeholder: \"Search by name or email..\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        onClick: this.findFriend,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"jam jam-search\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      })))), React.createElement(\"div\", {\n        className: \"invite-friend\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }, \"Invite friends to Newroots\"), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      }, \"Ask your close ones who're missing to join you.\"), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, this.state.invitedFriend), React.createElement(\"div\", {\n        className: \"network-input\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"email\",\n        placeholder: \"Enter their email..\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        onClick: this.inviteFriend,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }, \"invite\"))), length !== 0 ? React.createElement(\"h2\", {\n        className: \"friend-result-heading\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }, 'Found ' + length + ' people on Newroots') : React.createElement(\"h2\", {\n        className: \"friend-result-heading\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }, \"Couldn't find anyone.\"), React.createElement(\"div\", {\n        className: \"friend-results\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }, suggestions));\n    }\n  }]);\n\n  return AddFriend;\n}(React.Component);\n\n;\nexport default AddFriend;","map":{"version":3,"sources":["/Volumes/Angela He/treehacks/src/components/Network/AddFriend.js"],"names":["React","plant","$","Avatar","UserRow","ListOfUsers","StaticUtil","AddFriend","props","setFindFriend","mssg","setState","addedFriend","setInvitedFriend","invitedFriend","inviteFriend","genList","ref","search_val","tempSug","get","then","querySnapshot","forEach","doc","push","uid","id","name","data","url","PpfURL","suggestions","catch","err","sendRequest","firebase","requests","set","exists","findFriend","val","isValidEmail","users","where","toLowerCase","acceptRequest","removeRequest","addToNetwork","addToFeed","delete","renderUser","user","key","state","network","nextProps","length","map","sug","index","setUserPage","setAddFriend","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport plant from '../../graphics/icon.png';\nimport $ from 'jquery';\nimport Avatar from '../Misc/Avatar';\nimport UserRow from './UserRow'\nimport ListOfUsers from './ListOfUsers'\nimport StaticUtil from '../../data/StaticUtil'\n\nclass AddFriend extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      requests: this.props.requests,\n      network: this.props.network,\n      addedFriend: '',\n      invitedFriend: '',\n      suggestions: []\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.requests !== this.state.requests) {\n      this.setState({ requests: nextProps.requests });\n    }\n    if (nextProps.network !== this.state.network) {\n      this.setState({ network: nextProps.network });\n    }\n  }\n\n  setFindFriend = (mssg) => this.setState({ addedFriend: mssg });\n\n  setInvitedFriend = (mssg) => this.setState({ invitedFriend: mssg });\n\n  inviteFriend = () => this.setInvitedFriend('invited!');\n\n  genList = (ref, search_val) => {\n    let tempSug = [];\n    ref.get()\n      .then(querySnapshot => {\n        querySnapshot.forEach((doc) => {\n          tempSug.push({\n            uid: doc.id,\n            name: doc.data().name,\n            url: doc.data().PpfURL\n          })\n        });\n        this.setState({\n          suggestions: tempSug\n        })\n      })\n      .catch(err => {\n        this.setFindFriend(\"couldn't find \" + search_val);\n      });\n  }\n\n  sendRequest = (uid) => {\n    this.props.firebase.requests(uid)\n      .doc(this.props.uid)\n      .set({ exists: true })\n      .then(() => {\n        this.setFindFriend('sent request!');\n      });\n  }\n\n  findFriend = () => {\n    let ref = \"\";\n    let search_val = $('#add-friend-email').val();\n    if (StaticUtil.isValidEmail(search_val)) {\n      ref = this.props.firebase.users().where(\"email\", \"==\", search_val);\n    }\n    else {\n      search_val = search_val.toLowerCase();\n      ref = this.props.firebase.users().where(\"easy_name\", \"==\", search_val);\n    }\n\n    this.genList(ref, search_val);\n  };\n\n  acceptRequest = (uid) => {\n    //remove uid from your request\n    this.removeRequest(uid);\n\n    this.props.firebase.addToNetwork(this.props.uid, uid);\n\n    this.props.firebase.addToFeed(this.props.uid, uid);\n  }\n\n  removeRequest = (uid) => {\n    this.props.firebase.requests(this.props.uid).doc(uid).delete();\n  }\n\n  renderUser = (user, key) =>\n    <div className=\"preview\" key={key}>\n      <Avatar PpfURL={user.PpfURL} />\n      <p>{user.name}</p>\n      <div className=\"yesno\">\n        <button className=\"yes\" onClick={() => this.acceptRequest(user.uid)}>\n          <span className=\"jam jam-check\"></span>\n        </button>\n        <button className=\"no\" onClick={() => this.removeRequest(user.uid)}>\n          <span className=\"jam jam-close\"> </span>\n        </button>\n      </div>\n    </div>\n\n  render() {\n    let length = this.state.suggestions.length;\n\n    const suggestions = this.state.suggestions.map((sug, index) =>\n      <UserRow\n        onProfileClick={() => this.props.setUserPage(sug)}\n        PpfURL={sug.url}\n        name={sug.name}\n        rightElement={\n          <button onClick={() => this.sendRequest(sug.uid)}>\n            <span className=\"jam jam-user-plus\" ></span>\n          </button>\n        }\n      />\n    );\n\n    return (\n      <div className=\"modal network\">\n        <button className=\"close\" onClick={() => this.props.setAddFriend(false)}>\n          <span className=\"jam jam-close\"></span>\n        </button>\n        <img className=\"plant\" src={plant}></img>\n\n        <ListOfUsers\n          containerClass='scrolling-row'\n          firebase={this.props.firebase}\n          uid={this.props.uid}\n          listName='requests'\n          renderFunc={this.renderUser}\n        />\n\n        <div className=\"add-friend\">\n          <h2>Find friends</h2>\n          <p> {this.state.addedFriend} </p>\n          <div className=\"network-input\">\n            <input id=\"add-friend-email\" type=\"email\"\n              placeholder=\"Search by name or email..\"></input>\n            <button onClick={this.findFriend}>\n              <span className=\"jam jam-search\" ></span>\n            </button>\n          </div>\n        </div>\n\n        <div className=\"invite-friend\">\n          <h2>Invite friends to Newroots</h2>\n          <p>Ask your close ones who're missing to join you.</p>\n          <p>{this.state.invitedFriend}</p>\n          <div className=\"network-input\">\n            <input type=\"email\" placeholder=\"Enter their email..\"></input>\n            <button onClick={this.inviteFriend}>invite</button>\n          </div>\n        </div>\n\n        {length !== 0 ?\n          <h2 className=\"friend-result-heading\">{'Found ' + length + ' people on Newroots'}</h2> :\n          <h2 className=\"friend-result-heading\">Couldn't find anyone.</h2>}\n\n        <div className=\"friend-results\">\n          {suggestions}\n        </div>\n\n      </div>\n    );\n  }\n};\n\nexport default AddFriend;"]},"metadata":{},"sourceType":"module"}