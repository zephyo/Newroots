{"ast":null,"code":"import _classCallCheck from \"/Volumes/Angela He/treehacks/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Volumes/Angela He/treehacks/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Volumes/Angela He/treehacks/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Volumes/Angela He/treehacks/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Volumes/Angela He/treehacks/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Volumes/Angela He/treehacks/src/components/Network/NetworkTab.js\";\nimport React from 'react';\nimport AddFriend from './AddFriend';\nimport { withFirebase } from '../Firebase';\nimport UserPage from './UserPage';\nimport UserRow from './UserRow';\nimport graphics3 from '../../graphics/3.png';\nimport ErrorMsg from '../Misc/ErrorMsg';\nvar AddFriendFB = withFirebase(AddFriend);\n\nvar NetworkTab =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(NetworkTab, _React$Component);\n\n  function NetworkTab(props) {\n    var _this;\n\n    _classCallCheck(this, NetworkTab);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(NetworkTab).call(this, props));\n\n    _this.setAddFriend = function (bool) {\n      _this.setState({\n        addFriend: bool\n      });\n    };\n\n    _this.filterNetwork = function (event) {\n      var word = event.target.value;\n    };\n\n    _this.setRequests = function (requests) {\n      _this.setState({\n        requests: requests\n      });\n\n      _this.props.setRequests(requests);\n    };\n\n    _this.setNetworkUsers = function (network) {\n      var users = _this.state.networkUsers;\n\n      if (users == null || users.length == 0) {\n        _this.setState({\n          network: network\n        });\n\n        _this.loadNetworkUsers();\n      } else {\n        //dfind difference  btw n prev state and this state, add to networkUsers\n        var prev = _this.state.network;\n        var difference = network.filter(function (i) {\n          return prev.indexOf(i) < 0;\n        });\n        difference.forEach(function (val) {\n          _this.props.firebase.user(val).get().then(function (doc) {\n            users.push(doc.data());\n\n            _this.setState({\n              networkUsers: users\n            });\n          });\n        });\n\n        _this.setState({\n          network: network\n        });\n      }\n\n      _this.props.updateUserData('network', network);\n    };\n\n    _this.loadNetworkUsers = function () {\n      _this.setState({\n        loading: true,\n        networkUsers: []\n      });\n\n      var users = [];\n      var counter = 0;\n\n      for (var i = 0; i < _this.state.network.length; i++) {\n        _this.props.firebase.user(_this.state.network[i]).get().then(function (doc) {\n          users.push(doc.data());\n\n          _this.setState({\n            networkUsers: users\n          });\n\n          counter++;\n\n          if (counter === _this.state.network.length) {\n            _this.setState({\n              loading: false\n            });\n          }\n        });\n      }\n    };\n\n    _this.closeUserPage = function () {\n      _this.setState({\n        showUser: null\n      });\n    };\n\n    _this.setUser = function (user) {\n      _this.setState({\n        showUser: user\n      });\n    };\n\n    _this.state = {\n      addFriend: false,\n      network: _this.props.network,\n      networkUsers: [],\n      loading: false,\n      requests: _this.props.requests,\n      showUser: null\n    };\n    return _this;\n  }\n\n  _createClass(NetworkTab, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var ref = this.props.firebase.user(this.props.uid);\n      ref.onSnapshot(function (doc) {\n        var data = doc.data();\n\n        _this2.setNetworkUsers(data.network);\n\n        _this2.props.updateUserData('requests', data.requests);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      if ((!this.state.networkUsers || this.state.networkUsers.length === 0) && this.state.network.length > 0) {\n        if (this.state.loading == false) {\n          this.loadNetworkUsers();\n        }\n      }\n\n      var alert = null;\n\n      if (this.state.requests.length > 0) {\n        alert = React.createElement(\"span\", {\n          className: \"alert\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 117\n          },\n          __self: this\n        }, this.state.requests.length);\n      }\n\n      var network = [];\n\n      var _loop = function _loop() {\n        var user = _this3.state.networkUsers[i];\n        if (user == undefined) return \"continue\";\n        addEl = React.createElement(UserRow, {\n          key: 'row_' + i,\n          onProfileClick: function onProfileClick() {\n            return _this3.setUser(user);\n          },\n          PpfURL: user.PpfURL,\n          name: user.name,\n          rightElement: React.createElement(\"button\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 131\n            },\n            __self: this\n          }, React.createElement(\"span\", {\n            className: \"jam jam-heart\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 131\n            },\n            __self: this\n          })),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126\n          },\n          __self: this\n        });\n        network.push(addEl);\n      };\n\n      for (var i = 0; i < this.state.networkUsers.length; i++) {\n        var addEl;\n\n        var _ret = _loop();\n\n        if (_ret === \"continue\") continue;\n      }\n\n      var userPage = null;\n\n      if (this.state.showUser !== null) {\n        var showUser = this.state.showUser;\n        userPage = React.createElement(UserPage, {\n          closeUserPage: this.closeUserPage,\n          PpfURL: showUser.PpfURL,\n          name: showUser.name,\n          bio: showUser.bio,\n          location: showUser.location,\n          pronouns: showUser.pronouns,\n          checkins: showUser.checkinData,\n          network: showUser.network,\n          theirUID: showUser.uid,\n          myUID: this.props.uid,\n          firebase: this.props.firebase,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 143\n          },\n          __self: this\n        });\n      }\n\n      return React.createElement(\"section\", {\n        className: \"network\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"network-header\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }, \"Your support network\"), React.createElement(\"div\", {\n        className: \"header\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"search-bar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        placeholder: \"Search\",\n        onChange: this.filterNetwork,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"jam jam-search\",\n        style: {\n          color: '#9FC6C1'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      }))), React.createElement(\"button\", {\n        id: \"add-friends\",\n        onClick: function onClick() {\n          return _this3.setAddFriend(true);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"jam jam-user-plus\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }, alert)))), React.createElement(\"div\", {\n        className: \"friends\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      }, this.state.network.length == 0 ? React.createElement(ErrorMsg, {\n        src: graphics3,\n        header: \"Your network hasn't been created yet.\",\n        msg: \"Why not invite someone you trust?\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }) : network), this.state.addFriend ? React.createElement(AddFriendFB, {\n        setUserPage: this.setUser,\n        setAddFriend: this.setAddFriend,\n        uid: this.props.uid,\n        requests: this.state.requests,\n        network: this.state.network,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }) : null, userPage);\n    }\n  }]);\n\n  return NetworkTab;\n}(React.Component);\n\n;\nexport default NetworkTab;","map":{"version":3,"sources":["/Volumes/Angela He/treehacks/src/components/Network/NetworkTab.js"],"names":["React","AddFriend","withFirebase","UserPage","UserRow","graphics3","ErrorMsg","AddFriendFB","NetworkTab","props","setAddFriend","bool","setState","addFriend","filterNetwork","event","word","target","value","setRequests","requests","setNetworkUsers","network","users","state","networkUsers","length","loadNetworkUsers","prev","difference","filter","i","indexOf","forEach","val","firebase","user","get","then","doc","push","data","updateUserData","loading","counter","closeUserPage","showUser","setUser","ref","uid","onSnapshot","alert","undefined","addEl","PpfURL","name","userPage","bio","location","pronouns","checkinData","color","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport AddFriend from './AddFriend';\nimport { withFirebase } from '../Firebase';\nimport UserPage from './UserPage';\nimport UserRow from './UserRow'\n\nimport graphics3 from '../../graphics/3.png';\nimport ErrorMsg from '../Misc/ErrorMsg';\n\nconst AddFriendFB = withFirebase(AddFriend);\n\nclass NetworkTab extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      addFriend: false,\n      network: this.props.network,\n      networkUsers: [],\n      loading: false,\n      requests: this.props.requests,\n      showUser: null\n    };\n  }\n\n  componentDidMount() {\n    let ref = this.props.firebase.user(this.props.uid);\n\n    ref.onSnapshot((doc) => {\n      let data = doc.data();\n      this.setNetworkUsers(data.network);\n      this.props.updateUserData('requests', data.requests);\n    })\n  }\n\n  setAddFriend = (bool) => {\n    this.setState({\n      addFriend: bool\n    });\n  }\n\n  filterNetwork = (event) => {\n    let word = event.target.value;\n  }\n\n  setRequests = (requests) => {\n    this.setState({ requests: requests });\n    this.props.setRequests(requests);\n  }\n\n  //expect: array of uids\n  setNetworkUsers = (network) => {\n    let users = this.state.networkUsers;\n    if (users == null || users.length == 0) {\n      this.setState({ network: network });\n      this.loadNetworkUsers();\n    }\n    else {\n      //dfind difference  btw n prev state and this state, add to networkUsers\n      let prev = this.state.network;\n\n      let difference = network.filter(function (i) { return prev.indexOf(i) < 0 });\n\n      difference.forEach((val) => {\n        this.props.firebase\n          .user(val)\n          .get().then((doc) => {\n            users.push(doc.data());\n            this.setState({ networkUsers: users });\n          });\n      });\n      this.setState({ network: network });\n    }\n    this.props.updateUserData('network', network);\n  }\n\n  loadNetworkUsers = () => {\n    this.setState({ loading: true, networkUsers: [] });\n    let users = [];\n    let counter = 0;\n\n    for (let i = 0; i < this.state.network.length; i++) {\n\n      this.props.firebase\n        .user(this.state.network[i])\n        .get().then((doc) => {\n          users.push(doc.data());\n          this.setState({ networkUsers: users });\n          counter++;\n          if (counter === this.state.network.length) {\n            this.setState({ loading: false });\n          }\n        });\n    }\n  }\n\n\n  closeUserPage = () => {\n    this.setState({ showUser: null })\n  }\n\n  setUser = (user) => {\n    this.setState({ showUser: user })\n  }\n\n\n  render() {\n    if ((!this.state.networkUsers || this.state.networkUsers.length === 0) &&\n      this.state.network.length > 0) {\n      if (this.state.loading == false) {\n        this.loadNetworkUsers();\n      }\n    }\n\n    let alert = null;\n    if (this.state.requests.length > 0) {\n      alert = (\n        <span className=\"alert\">{this.state.requests.length}</span>\n      );\n    }\n\n    let network = [];\n    for (var i = 0; i < this.state.networkUsers.length; i++) {\n      let user = this.state.networkUsers[i];\n      if (user == undefined) continue;\n      var addEl = (\n        <UserRow\n          key={'row_' + i}\n          onProfileClick={() => this.setUser(user)}\n          PpfURL={user.PpfURL}\n          name={user.name}\n          rightElement={<button><span className=\"jam jam-heart\" ></span></button>}\n        />\n      );\n      network.push(addEl);\n    }\n\n\n    let userPage = null;\n\n    if (this.state.showUser !== null) {\n      let showUser = this.state.showUser;\n      userPage =\n        <UserPage\n          closeUserPage={this.closeUserPage}\n          PpfURL={showUser.PpfURL}\n          name={showUser.name}\n          bio={showUser.bio}\n          location={showUser.location}\n          pronouns={showUser.pronouns}\n          checkins={showUser.checkinData}\n          network={showUser.network}\n          theirUID={showUser.uid}\n          myUID={this.props.uid}\n          firebase={this.props.firebase}\n        ></UserPage>\n    }\n\n\n    return (\n      <section className=\"network\">\n        <div className=\"network-header\">\n          <h2>Your support network</h2>\n          <div className=\"header\">\n            <div className=\"search-bar\">\n              <input type=\"text\" placeholder=\"Search\" onChange={this.filterNetwork} />\n              <button><span className=\"jam jam-search\" style={{ color: '#9FC6C1' }}></span></button>\n            </div>\n            <button id=\"add-friends\" onClick={() => this.setAddFriend(true)} >\n              <span className=\"jam jam-user-plus\">\n                {alert}\n              </span>\n            </button>\n          </div>\n        </div>\n\n        <div className=\"friends\">\n          {this.state.network.length == 0 ?\n            <ErrorMsg\n              src={graphics3}\n              header=\"Your network hasn't been created yet.\"\n              msg='Why not invite someone you trust?'\n            />\n            : network\n          }\n        </div>\n        {(this.state.addFriend ?\n          <AddFriendFB\n            setUserPage={this.setUser}\n            setAddFriend={this.setAddFriend}\n            uid={this.props.uid}\n            requests={this.state.requests}\n            network={this.state.network}\n          /> : null)}\n\n        {userPage}\n\n      </section>\n    );\n  }\n};\n\nexport default NetworkTab;"]},"metadata":{},"sourceType":"module"}